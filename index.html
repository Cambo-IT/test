<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"​ content="Cambo-IT's simple form of leave of absence letter. This form was reated to generate the image of absence letter.">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <title>Absence Form</title>
    <script>
        async function handleForm(event) {
          event.preventDefault(); // Prevent the default form submission
    
          const formData = new FormData(event.target);
    
          // Send form data using Fetch API
          try {
            const response = await fetch(event.target.action, {
              method: event.target.method,
              body: formData,
            });
    
            if (response.ok) {
              // Handle success
              console.log("Form submitted successfully!");
              alert("Form submitted successfully!");
            } else {
              // Handle error
              console.error("Error submitting form");
              alert("Failed to submit the form.");
            }
          } catch (error) {
            console.error("Network error:", error);
            // alert("An error occurred. Please try again.");
          }
        }
      </script>
</head>
<body>
    <div class="back" id="form">
        <form id="a-form" onsubmit="handleForm(event)" method="POST" action="https://docs.google.com/forms/d/e/1FAIpQLSeQUHdj5iaSyc-f32PQyOemMGtphhdbbL2Txz96v-6vnIc4MQ/formResponse">
            <h4>Leave of Absence Letter</h4>
            <input name="entry.1050276820" type="text" id="inName" lang="km" placeholder="ឈ្មោះ">
            <select style="width: 39%;float: left; margin-right: 2%;" id="inSex" placeholder="ភេទ" required>
                <option value="ភេទ" selected disabled hidden>ភេទ</option>
                <option value=2>ប្រុស</option>
                <option value=4>ស្រី</option>
            </select>
            <!-- <input style="width: 59%; " lang="km" type="text" id="inPosition" placeholder="តួនាទី" required> -->



                <!-- <label for="name">Name:</label><br>
                <input type="text" id="name" name="entry.1050276820" required><br><br>
                
                <label for="email">Email:</label><br>
                <input type="email" id="email" name="entry.100961081" required><br><br> -->
                 


                <!-- <button type="submit"  id="preview"><b>Preview 11</b></button> -->


            <select style="width: 59%; " id="inPosition" placeholder="សិក្សាវគ្គ" required>
                <option value="ជំនាញកុំព្យូទ័រ" selected disabled hidden>សិក្សាវគ្គ</option>
                <option value="កុំព្យូទ័ររដ្ឋបាល">កុំព្យូទ័ររដ្ឋបាល</option>
                <option value="ក្រាហ្វិកឌីហ្សាញ">ក្រាហ្វិកឌីហ្សាញ</option>
                <option value="កាត់តរូបភាព">កាត់តរូបភាព</option>
                <option value="កាត់តវីឌីអូ">កាត់តវីឌីអូ</option>
                <option value="ឌីហ្សាញ3D">ឌីហ្សាញ3D</option>
                <option value="រចនាប្លង់">រចនាប្លង់</option>
                <option value="គ្រប់គ្រងទិន្នន័យ">គ្រប់គ្រងទិន្នន័យ</option>
                <option value="រចនាវេបសាយ">រចនាវេបសាយ</option>
            </select>

            <select style="width: 39%; float: left; margin-right: 2%;" id="inShift" placeholder="វេន​សិក្សា" required>
                <option value="ច័ន្ទ-សុក្រ" selected disabled hidden>វេន​សិក្សា</option>
                <option value="ច័ន្ទ-សុក្រ">ច័ន្ទ-សុក្រ</option>
                <option value="សៅរ៍-អាទិត្យ">សៅរ៍-អាទិត្យ</option>
            </select>
            <select style="width: 37%; float: left; margin-right: 2%;" id="inHour" value="" placeholder="ម៉ោង​សិក្សា" required>
                <option value=""  selected disabled hidden>ម៉ោង​សិក្សា</option>
                <option value="០១:០០">០១</option>
                <option value="០២:០០">០២</option>
                <option value="០៣:០០">០៣</option>
                <option value="០៤:០០">០៤</option>
                <option value="០៥:០០">០៥</option>
                <option value="០៦:០០">០៦</option>
                <option value="០៧:០០">០៧</option>
                <option value="០៨:០០">០៨</option>
                <option value="០៩:០០">០៩</option>
                <option value="១០:០០">១០</option>
                <option value="១១:០០">១១</option>
                <option value="១២:០០">១២</option>
            </select>
            <select style="width: 20%; " id="inPmAm" placeholder="PM/AM" required>
                <option value="PM">PM</option>
                <option value="AM">AM</option>
            </select>

            <script>
                function myFunction(x) {
                    document.getElementById("inDays").defaultValue = "០១";
                }
            </script>
            <input style="width: 71%; float: left; margin-right: 2%; " lang="km" type="text" onfocus="myFunction(this)" id="inDays" value="" maxlength="5" placeholder="ចំនួនថ្ងៃឈប់សម្រាក">
            
            <select style="width: 27%;"  id="inTime" placeholder="ថ្ងៃ" required>
                <option value="ថ្ងៃ" selected >ថ្ងៃ</option>
                <option value="ព្រឹក">ព្រឹក</option>
                <option value="ល្ងាច">ល្ងាច</option>
            </select>

        

            
            <select style="width: 44%; float: left; margin-right: 2%;" id="inDateF" placeholder="ចាប់ពីថ្ងៃទី..." required>
                <option value="ថ្ងៃទី" selected disabled hidden>ចាប់ពីថ្ងៃទី</option>
                <option value="០១">០១</option>
                <option value="០២">០២</option>
                <option value="០៣">០៣</option>
                <option value="០៤">០៤</option>
                <option value="០៥">០៥</option>
                <option value="០៦">០៦</option>
                <option value="០៧">០៧</option>
                <option value="០៨">០៨</option>
                <option value="០៩">០៩</option>
                <option value="១០">១០</option>
                <option value="១១">១១</option>
                <option value="១២">១២</option>
                <option value="១៣">១៣</option>
                <option value="១៤">១៤</option>
                <option value="១៥">១៥</option>
                <option value="១៦">១៦</option>
                <option value="១៧">១៧</option>
                <option value="១៨">១៨</option>
                <option value="១៩">១៩</option>
                <option value="២០">២០</option>
                <option value="២១">២១</option>
                <option value="២២">២២</option>
                <option value="២៣">២៣</option>
                <option value="២៤">២៤</option>
                <option value="២៥">២៥</option>
                <option value="២៦">២៦</option>
                <option value="២៧">២៧</option>
                <option value="២៨">២៨</option>
                <option value="២៩">២៩</option>
                <option value="៣០">៣០</option>
                <option value="៣១">៣១</option>
            </select>
            <input type="text" style="width: 25%; float: left; margin-right: 2%;" aria-label="inMonthF" id="inMonthF" value="" required>
            <select style="width: 27%; " id="inYearF" placeholder="ឆ្នាំ..." required>
                <option value="២០២៤">២០២៤</option>
                <option value="២០២៥">២០២៥</option>
                <option value="២០២៦">២០២៦</option>
                <option value="២០២៧">២០២៧</option>
                <option value="២០២៨">២០២៨</option>
            </select>

            <select style="width: 44%; float: left; margin-right: 2%;" id="inDateT" placeholder="ចាប់ពីថ្ងៃទី..." required>
                <option value="ថ្ងៃទី" selected disabled hidden>ដល់ថ្ងៃទី</option>
                <option value="០១">០១</option>
                <option value="០២">០២</option>
                <option value="០៣">០៣</option>
                <option value="០៤">០៤</option>
                <option value="០៥">០៥</option>
                <option value="០៦">០៦</option>
                <option value="០៧">០៧</option>
                <option value="០៨">០៨</option>
                <option value="០៩">០៩</option>
                <option value="១០">១០</option>
                <option value="១១">១១</option>
                <option value="១២">១២</option>
                <option value="១៣">១៣</option>
                <option value="១៤">១៤</option>
                <option value="១៥">១៥</option>
                <option value="១៦">១៦</option>
                <option value="១៧">១៧</option>
                <option value="១៨">១៨</option>
                <option value="១៩">១៩</option>
                <option value="២០">២០</option>
                <option value="២១">២១</option>
                <option value="២២">២២</option>
                <option value="២៣">២៣</option>
                <option value="២៤">២៤</option>
                <option value="២៥">២៥</option>
                <option value="២៦">២៦</option>
                <option value="២៧">២៧</option>
                <option value="២៨">២៨</option>
                <option value="២៩">២៩</option>
                <option value="៣០">៣០</option>
                <option value="៣១">៣១</option>
            </select>
            <input type="text" style="width: 25%; float: left; margin-right: 2%;" aria-label="inMonthT" id="inMonthT" value="" required>
            <select style="width: 27%; " id="inYearT" placeholder="ឆ្នាំ..." required>
                <option value="២០២៤">២០២៤</option>
                <option value="២០២៥">២០២៥</option>
                <option value="២០២៦">២០២៦</option>
                <option value="២០២៧">២០២៧</option>
                <option value="២០២៨">២០២៨</option>
            </select>
            <select style="width: 44%; float: left; margin-right: 2%;" id="inDateI" placeholder="ចាប់ពីថ្ងៃទី..." required>
                <option value="ថ្ងៃទី" selected disabled hidden>ចូលរៀនវិញថ្ងៃទី</option>
                <option value="០១">០១</option>
                <option value="០២">០២</option>
                <option value="០៣">០៣</option>
                <option value="០៤">០៤</option>
                <option value="០៥">០៥</option>
                <option value="០៦">០៦</option>
                <option value="០៧">០៧</option>
                <option value="០៨">០៨</option>
                <option value="០៩">០៩</option>
                <option value="១០">១០</option>
                <option value="១១">១១</option>
                <option value="១២">១២</option>
                <option value="១៣">១៣</option>
                <option value="១៤">១៤</option>
                <option value="១៥">១៥</option>
                <option value="១៦">១៦</option>
                <option value="១៧">១៧</option>
                <option value="១៨">១៨</option>
                <option value="១៩">១៩</option>
                <option value="២០">២០</option>
                <option value="២១">២១</option>
                <option value="២២">២២</option>
                <option value="២៣">២៣</option>
                <option value="២៤">២៤</option>
                <option value="២៥">២៥</option>
                <option value="២៦">២៦</option>
                <option value="២៧">២៧</option>
                <option value="២៨">២៨</option>
                <option value="២៩">២៩</option>
                <option value="៣០">៣០</option>
                <option value="៣១">៣១</option>
            </select>
            <input type="text" style="width: 25%; float: left; margin-right: 2%;" aria-label="inMonthI" id="inMonthI" value="" required>
            <select style="width: 27%; " id="inYearI" placeholder="ឆ្នាំ..." required>
                <option value="២០២៤">២០២៤</option>
                <option value="២០២៥">២០២៥</option>
                <option value="២០២៦">២០២៦</option>
                <option value="២០២៧">២០២៧</option>
                <option value="២០២៨">២០២៨</option>
            </select>
            <input type="text" lang="km" id="inReason" placeholder="មូលហេតុ...">
            <!-- <button type="submit">Send</button>
            <button type="submit" id="preview"><b>Preview</b></button> -->
            <button type="submit"  id="preview" ><b>Preview</b></button>

        </form>

        <!-- form="a-form" -->



        <div  hidden> 
            <ul>
                <li id="name"></li>
                <li id="sex"></li>
                <li id="position"></li>
                <li id="days"></li>
                <li id="datef"></li>
                <li id="datet"></li>
                <li id="datei"></li>
                <li id="reason"></li>
                <li id="time"></li>
                <li id="shift"></li>
                <li id="hour"></li>
                <li id="pmam"></li>
            </ul>
            <img src="./Sremeas-Logo.webp" id="logo">
        </div>
    </div>
    
    <div class="container" id="show">
        <div class="preferably-square">
            <canvas id="result" width="720px" height="740px"></canvas>
        </div>
        <button style="margin-right: auto; margin-left: auto;" id="down"><b>Download</b></button>&nbsp;
        <button style="font-size: 18px; margin-right: auto; margin-left: auto;" onClick="onShares()"><b>Share Image</b></button>
    </div>
	
    <script>
      window.addEventListener("load", function(){
      const d = new Date();
      let month = d.getMonth();
        switch(month) {
        case 0:
         document.getElementById("inMonthF").defaultValue = "មករា";
         document.getElementById("inMonthT").defaultValue = "មករា";
         document.getElementById("inMonthI").defaultValue = "មករា";
         break;
        case 1:
         document.getElementById("inMonthF").defaultValue = "កុម្ភៈ";
         document.getElementById("inMonthT").defaultValue = "កុម្ភៈ";
         document.getElementById("inMonthI").defaultValue = "កុម្ភៈ";
         break;
        case 2:
         document.getElementById("inMonthF").defaultValue = "មីនា";
         document.getElementById("inMonthT").defaultValue = "មីនា";
         document.getElementById("inMonthI").defaultValue = "មីនា";
         break;
        case 3:
         document.getElementById("inMonthF").defaultValue = "មេសា";
         document.getElementById("inMonthT").defaultValue = "មេសា";
         document.getElementById("inMonthI").defaultValue = "មេសា";
         break;
        case 4:
         document.getElementById("inMonthF").defaultValue = "ឧសភា";
         document.getElementById("inMonthT").defaultValue = "ឧសភា";
         document.getElementById("inMonthI").defaultValue = "ឧសភា";
         break;
        case 5:
         document.getElementById("inMonthF").defaultValue = "មិថុនា";
         document.getElementById("inMonthT").defaultValue = "មិថុនា";
         document.getElementById("inMonthI").defaultValue = "មិថុនា";
         break;
        case 6:
         document.getElementById("inMonthF").defaultValue = "កក្កដា";
         document.getElementById("inMonthT").defaultValue = "កក្កដា";
         document.getElementById("inMonthI").defaultValue = "កក្កដា";
         break;
        case 7:
         document.getElementById("inMonthF").defaultValue = "សីហា";
         document.getElementById("inMonthT").defaultValue = "សីហា";
         document.getElementById("inMonthI").defaultValue = "សីហា";
         break;
        case 8:
         document.getElementById("inMonthF").defaultValue = "កញ្ញា";
         document.getElementById("inMonthT").defaultValue = "កញ្ញា";
         document.getElementById("inMonthI").defaultValue = "កញ្ញា";
         break;
        case 9:
         document.getElementById("inMonthF").defaultValue = "តុលា";
         document.getElementById("inMonthT").defaultValue = "តុលា";
         document.getElementById("inMonthI").defaultValue = "តុលា";
         break;
        case 10:
         document.getElementById("inMonthF").defaultValue = "វិច្ឆិកា";
         document.getElementById("inMonthT").defaultValue = "វិច្ឆិកា";
         document.getElementById("inMonthI").defaultValue = "វិច្ឆិកា";
         break;
        default:
         document.getElementById("inMonthF").defaultValue = "ធ្នូ";
         document.getElementById("inMonthT").defaultValue = "ធ្នូ";
         document.getElementById("inMonthI").defaultValue = "ធ្នូ";
      }
      });
      </script>
	  
      <script>
        var inSex = document.getElementById('inSex');
        inSex.onchange = function () {
        inSex.className = this.options[this.selectedIndex].className;
        }
      </script>
	  
  <script src="main.js"></script>
</body >
</html >
